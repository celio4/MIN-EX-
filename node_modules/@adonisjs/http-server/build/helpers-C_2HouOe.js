function findRoute(domainsRoutes, routeIdentifier, domain, method, disableLegacyLookup) {
	if (!domain) {
		let route = null;
		for (const routeDomain of Object.keys(domainsRoutes)) {
			route = findRoute(domainsRoutes, routeIdentifier, routeDomain, method, disableLegacyLookup);
			if (route) break;
		}
		return route;
	}
	const routes = domainsRoutes[domain];
	if (!routes) return null;
	const lookupByPattern = !disableLegacyLookup;
	const lookupByController = !disableLegacyLookup;
	return routes.find((route) => {
		if (method && !route.methods.includes(method)) return false;
		if (route.name === routeIdentifier || lookupByPattern && route.pattern === routeIdentifier) return true;
		if (lookupByController && route.handler && typeof route.handler === "object") return "reference" in route.handler && route.handler.reference === routeIdentifier;
		return false;
	}) || null;
}
function createURL(pattern, tokens, searchParamsStringifier, params, options) {
	const uriSegments = [];
	const paramsArray = Array.isArray(params) ? params : null;
	const paramsObject = !Array.isArray(params) ? params ?? {} : {};
	let paramsIndex = 0;
	for (const token of tokens) {
		if (token.type === 0) {
			uriSegments.push(token.val === "/" ? "" : `${token.val}${token.end}`);
			continue;
		}
		if (token.type === 2) {
			const values = paramsArray ? paramsArray.slice(paramsIndex) : paramsObject["*"];
			if (!Array.isArray(values) || !values.length) throw new Error(`Cannot make URL for "${pattern}". Invalid value provided for the wildcard param`);
			uriSegments.push(`${values.join("/")}${token.end}`);
			break;
		}
		const paramName = token.val;
		const value = paramsArray ? paramsArray[paramsIndex] : paramsObject[paramName];
		const isDefined = value !== void 0 && value !== null;
		if (token.type === 1 && !isDefined) throw new Error(`Cannot make URL for "${pattern}". Missing value for the "${paramName}" param`);
		if (isDefined) uriSegments.push(`${value}${token.end}`);
		paramsIndex++;
	}
	let URI = `/${uriSegments.join("/")}`;
	if (options?.prefixUrl) URI = `${options?.prefixUrl.replace(/\/$/, "")}${URI}`;
	if (options?.qs) {
		const queryString = searchParamsStringifier(options?.qs);
		URI = queryString ? `${URI}?${queryString}` : URI;
	}
	return URI;
}
export { findRoute as n, createURL as t };
