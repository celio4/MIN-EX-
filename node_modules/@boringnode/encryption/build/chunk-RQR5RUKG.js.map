{"version":3,"sources":["../src/safe_equal.ts"],"sourcesContent":["/*\n * @boringnode/encryption\n *\n * @license MIT\n * @copyright Boring Node\n */\n\nimport { timingSafeEqual, createHmac, randomBytes } from 'node:crypto'\n\nconst hmacKey = randomBytes(32)\n\nexport function safeEqual(\n  a: string | ArrayBuffer | SharedArrayBuffer | Uint8Array | Buffer,\n  b: string | ArrayBuffer | SharedArrayBuffer | Uint8Array | Buffer\n) {\n  const bufferA = typeof a === 'string' ? Buffer.from(a, 'utf8') : Buffer.from(a as ArrayBuffer)\n  const bufferB = typeof b === 'string' ? Buffer.from(b, 'utf8') : Buffer.from(b as ArrayBuffer)\n\n  const hmacA = createHmac('sha256', hmacKey).update(bufferA).digest()\n  const hmacB = createHmac('sha256', hmacKey).update(bufferB).digest()\n\n  return timingSafeEqual(hmacA, hmacB)\n}\n"],"mappings":";AAOA,SAAS,iBAAiB,YAAY,mBAAmB;AAEzD,IAAM,UAAU,YAAY,EAAE;AAEvB,SAAS,UACd,GACA,GACA;AACA,QAAM,UAAU,OAAO,MAAM,WAAW,OAAO,KAAK,GAAG,MAAM,IAAI,OAAO,KAAK,CAAgB;AAC7F,QAAM,UAAU,OAAO,MAAM,WAAW,OAAO,KAAK,GAAG,MAAM,IAAI,OAAO,KAAK,CAAgB;AAE7F,QAAM,QAAQ,WAAW,UAAU,OAAO,EAAE,OAAO,OAAO,EAAE,OAAO;AACnE,QAAM,QAAQ,WAAW,UAAU,OAAO,EAAE,OAAO,OAAO,EAAE,OAAO;AAEnE,SAAO,gBAAgB,OAAO,KAAK;AACrC;","names":[]}