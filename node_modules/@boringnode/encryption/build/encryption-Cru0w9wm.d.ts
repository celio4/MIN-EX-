import { MessageVerifier } from './src/message_verifier.js';
import { EncryptionConfig, EncryptOptions, CypherText } from './src/types/main.js';

/**
 * Encryption class that wraps a driver and manages multiple keys.
 * Encrypts with the first key, decrypts by trying all keys.
 */
declare class Encryption {
    #private;
    constructor(config: EncryptionConfig);
    /**
     * Encrypt a value using the first key
     */
    encrypt(payload: any, options?: EncryptOptions): CypherText;
    encrypt(payload: any, expiresIn?: string | number, purpose?: string): CypherText;
    /**
     * Decrypt a value by trying all keys
     */
    decrypt<T extends any>(value: string, purpose?: string): T | null;
    blindIndex(payload: any, purpose: string): string;
    blindIndexes(payload: any, purpose: string): string[];
    /**
     * Get the message verifier instance
     */
    getMessageVerifier(): MessageVerifier;
}

export { Encryption as E };
