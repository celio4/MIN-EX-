{"version":3,"sources":["../src/hmac.ts"],"sourcesContent":["/*\n * @boringnode/encryption\n *\n * @license MIT\n * @copyright Boring Node\n */\n\nimport { createHmac } from 'node:crypto'\nimport { safeEqual } from './safe_equal.ts'\nimport { base64UrlEncode } from './base64.ts'\n\n/**\n * A generic class for generating SHA-256 Hmac for verifying the value\n * integrity.\n */\nexport class Hmac {\n  #key: Buffer\n\n  constructor(key: Buffer) {\n    this.#key = key\n  }\n\n  /**\n   * Generate the hmac\n   */\n  generate(value: string) {\n    return base64UrlEncode(createHmac('sha256', this.#key).update(value).digest())\n  }\n\n  /**\n   * Compare raw value against an existing hmac\n   */\n  compare(value: string, existingHmac: string) {\n    return safeEqual(this.generate(value), existingHmac)\n  }\n}\n"],"mappings":";;;;;;;;AAOA,SAAS,kBAAkB;AAQpB,IAAM,OAAN,MAAW;AAAA,EAChB;AAAA,EAEA,YAAY,KAAa;AACvB,SAAK,OAAO;AAAA,EACd;AAAA;AAAA;AAAA;AAAA,EAKA,SAAS,OAAe;AACtB,WAAO,gBAAgB,WAAW,UAAU,KAAK,IAAI,EAAE,OAAO,KAAK,EAAE,OAAO,CAAC;AAAA,EAC/E;AAAA;AAAA;AAAA;AAAA,EAKA,QAAQ,OAAe,cAAsB;AAC3C,WAAO,UAAU,KAAK,SAAS,KAAK,GAAG,YAAY;AAAA,EACrD;AACF;","names":[]}