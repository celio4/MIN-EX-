import { BaseConfig, CypherText, EncryptOptions } from '../types/main.js';
import '@poppinss/utils';

declare abstract class BaseDriver {
    #private;
    /**
     * The key for encrypting values. It is derived
     * from the user provided secret.
     */
    cryptoKey: Buffer;
    /**
     * Use `dot` as a separator for joining encrypted value, iv and the
     * hmac hash. The idea is borrowed from JWTs.
     */
    separator: string;
    protected constructor(config: BaseConfig);
    protected computeReturns(values: string[]): CypherText;
    blindIndex(payload: any, purpose: string): string;
    blindIndexes(payload: any, purpose: string): string[];
    /**
     * Encrypt a given piece of value using the app secret. A wide range of
     * data types are supported.
     *
     * - String
     * - Arrays
     * - Objects
     * - Booleans
     * - Numbers
     * - Dates
     *
     * You can optionally define a purpose for which the value was encrypted and
     * mentioning a different purpose/no purpose during decrypt will fail.
     */
    abstract encrypt(payload: any, options?: EncryptOptions): CypherText;
    abstract encrypt(payload: any, expiresIn?: string | number, purpose?: string): CypherText;
    /**
     * Decrypt value and verify it against a purpose
     */
    abstract decrypt<T extends any>(value: string, purpose?: string): T | null;
}

export { BaseDriver };
