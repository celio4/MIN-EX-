import { Secret } from '@poppinss/utils';
import { BaseDriver } from './base_driver.js';
import { EncryptionDriverContract, ChaCha20Poly1305Config, EncryptOptions, CypherText } from '../types/main.js';

interface ChaCha20Poly1305DriverConfig {
    id: string;
    keys: (string | Secret<string>)[];
}
declare function chacha20poly1305(config: ChaCha20Poly1305DriverConfig): {
    driver: (key: string | Secret<string>) => ChaCha20Poly1305;
    keys: (string | Secret<string>)[];
};
declare class ChaCha20Poly1305 extends BaseDriver implements EncryptionDriverContract {
    #private;
    constructor(config: ChaCha20Poly1305Config);
    /**
     * Encrypt a given piece of value using the app secret. A wide range of
     * data types are supported.
     *
     * - String
     * - Arrays
     * - Objects
     * - Booleans
     * - Numbers
     * - Dates
     *
     * You can optionally define a purpose for which the value was encrypted and
     * mentioning a different purpose/no purpose during decrypt will fail.
     */
    encrypt(payload: any, options?: EncryptOptions): CypherText;
    encrypt(payload: any, expiresIn?: string | number, purpose?: string): CypherText;
    /**
     * Decrypt value and verify it against a purpose
     */
    decrypt<T extends any>(value: string, purpose?: string): T | null;
}

export { ChaCha20Poly1305, type ChaCha20Poly1305DriverConfig, chacha20poly1305 };
