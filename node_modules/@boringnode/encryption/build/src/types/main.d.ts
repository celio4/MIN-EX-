import { Secret } from '@poppinss/utils';

type CypherText = `${string}.${string}.${string}` | `${string}.${string}.${string}.${string}`;
/**
 * Options for the encrypt method
 */
interface EncryptOptions {
    expiresIn?: string | number;
    purpose?: string;
}
/**
 * The contract Encryption drivers should adhere to
 */
interface EncryptionDriverContract {
    /**
     * Encrypt a given piece of value using the app secret. A wide range of
     * data types are supported.
     *
     * - String
     * - Arrays
     * - Objects
     * - Booleans
     * - Numbers
     * - Dates
     *
     * You can optionally define a purpose for which the value was encrypted and
     * mentioning a different purpose/no purpose during decrypt will fail.
     */
    encrypt(payload: any, options?: EncryptOptions): CypherText;
    encrypt(payload: any, expiresIn?: string | number, purpose?: string): CypherText;
    /**
     * Decrypt value and verify it against a purpose
     */
    decrypt<T extends any>(value: string, purpose?: string): T | null;
    /**
     * Compute a deterministic blind index for equality lookups.
     */
    blindIndex(payload: any, purpose: string): string;
    /**
     * Compute blind indexes for all keys used by the driver.
     */
    blindIndexes(payload: any, purpose: string): string[];
}
/**
 * Factory function to return the driver implementation. The method
 * cannot be async because the API that calls this method is not
 * async in the first place.
 */
type ManagerDriverFactory = () => EncryptionDriverContract;
interface BaseConfig {
    key: string | Secret<string>;
    id?: string;
}
interface LegacyConfig extends BaseConfig {
}
interface AES256CBCConfig extends BaseConfig {
    id: string;
}
interface AES256GCMConfig extends BaseConfig {
    id: string;
}
interface ChaCha20Poly1305Config extends BaseConfig {
    id: string;
}
interface AESSIVConfig extends BaseConfig {
    id: string;
}
type Config<KnownEncrypters extends Record<string, ManagerDriverFactory>> = {
    default?: keyof KnownEncrypters;
    list: KnownEncrypters;
};
/**
 * Configuration for the Encryption class
 */
interface EncryptionConfig {
    /**
     * Factory function that creates a driver instance for a given key
     */
    driver: (key: string | Secret<string>) => EncryptionDriverContract;
    /**
     * List of keys to use for encryption/decryption.
     * The first key is used for encryption, all keys are tried for decryption.
     */
    keys: (string | Secret<string>)[];
}

export type { AES256CBCConfig, AES256GCMConfig, AESSIVConfig, BaseConfig, ChaCha20Poly1305Config, Config, CypherText, EncryptOptions, EncryptionConfig, EncryptionDriverContract, LegacyConfig, ManagerDriverFactory };
